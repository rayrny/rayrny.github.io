---
layout: posts
title: "[React] react-hook-form에 대한 짧은 고찰"
categories:
  - React
last_modified_at: 2023-01-30
author_profile: true
tags:
  - react-hook-form
  - react
toc: true
toc_sticky: true
sidebar:
  title: Posts
  nav: "sidebar-contents"
---

FilterDropdown을 만들던 중의 생각 변화의 흐름



## 개요

참고) `FilterDropdown` 컴포넌트는 input 두 개와 checkbox 하나를 가진 드롭다운 컴포넌트이다.

![filter](https://user-images.githubusercontent.com/48341341/215520739-159431e6-b5a0-429f-bdb1-db53798a8cea.png)

1. 처음에는 그냥 다 때려박아서 만들었다가
2. 진도율 input을 컴포넌트로 빼자 (invalid 피드백 등을 함께 관리하려고)
3. 이러니까 값이랑 에러를 다 props로 받아와야하네
4. 적당히 리팩토링
5. 기회 되면 input 관련 valid 체크하는거랑 다 커스텀 훅으로 제공해야지
6. 어? 그게 바로 react-hook-form..?

해서 리팩토링을 진행하게 된 것이었다.


## 본론

### 그래서,

열심히 react-hook-form으로 갈아치웠다. 

### 첫 번째 난관

아래처럼 진도율 구간 관련한 유효성 검사 로직이 필요했다. validate라는 항목 추가로 가능했는데, 에러 메세지 넘겨주는 부분에서도 살짝 애를 먹었었다. (공식 문서를 잘 찾아보면 친절하게 나와있는데 잘 안찾아본 자의 최후..)

![filter-error](https://user-images.githubusercontent.com/48341341/215521096-210bd0a5-e6b0-4e57-989b-fc276f3e537c.png)

```jsx
// 보통은 이렇게,
{
	max: {
		value: 100,
		message: '100보다 작은 숫자를 입력해주세요.'
	}
}

// 근데 커스텀하게 주는 경우는 이렇게..!
{
	validate: (v) => (v < max) || '에러 메세지...'
}
```

그래, 이건 해결했는데…

진도율 구간 관련 유효성 검사는 시작 구간(min)에만 추가하되, 끝 구간(max)이 변경되면 검사를 다시 해주어야 했다. (`[20, 10]`에서 `[20, 100]`으로 변경하면 invalid를 빼주어야하니까)

그래서 생각한 방법은 validate를 추가하지 않고 setErrors를 통해 min, max 값이 변경될 때마다 error를 set, reset 해주기였다.

> 아 지금 생각엔 저 유효성 문구를 min, max 둘 다에게 주고 유효성 검사할 때도 v가 아니라 min, max로 했으면..?


### 두 번째 난관
{작 성 중}

- checkbox
    - true → min, max 100으로 변경
    - false → min, max 이전 값(context에 적용되어 있던)으로 변경
    - 반대로 min, max가 변경될 때도 checkbox 상태가 맞추어 변경되어야 함
- isFiltering은 적용시킬 때만 변경해주고 싶었음
    - 근데 input 변경때마다 업데이트 되어서 문제
    
    > 이거는 apply 할 때만 판단하도록 하면 해결될 것 같다
    > 
- 어떠한 이유에서인지 input에 입력한 값들이 따로 state로 관리되어야 한다고 생각했었음
    - 이거는 내일 가서 코드를 봐야 알 것 같다.
- 적용하고, reset 하고, 각각의 input을 입력, 변경하는 과정에서 문제가 없던 부분이 동작하지 않게 되면서 기존 코드를 유지해야겠다는 판단을 내렸다.
    - 작업을 빨리 마무리해야한다는 약간의 압박감도 있었다.
    - 지금 생각해보면 해결할 수 있는 문제들이 꽤나 있어보이거든..!
- 또한 당시에는, react-hook-form을 적용하게 되면서 비즈니스 요구사항을 만족시키기 위한 다른 불필요한 코드들이 더 추가되었다는 생각에 쓰지 말아야겠다는 판단도 했었다.
    - ex. react-query를 사용하기 위한 더 많은 코드들
    - 근데, 유지 보수 측면에서 모두가 동일한 방식으로 코드를 작성하고 빠르게 이해할 수 있다는 점도 간과해서는 안되겠다.
        - 요구사항을 달성하기 위한 더욱 추가적인 코드들 vs 모두가 같은 방식으로 비동기 패칭을 해온다 (다른 개발자가 유지보수 하러 왔을 때 초기 이해가 쉽다)



## 결론

새로운 라이브러리를 처음 사용할 때는 실제로 적용된 코드를 보며 사용법을 빠르게 익히는 것도 중요하지만, 공식 문서를 정독하는 시간이 꼭 필요하다.

또한 항상 생각해야 할 것

- 이 라이브러리는 어떤 문제를 해결하기 위해 나온 것인가?
- 지금 내가 해결하고자 하는 문제에 대한 적합한 해결책인가?

위 질문을 꼭 먼저 해보도록 하자. 이제는 단순히 `빠르게 동작하는 코드를 만들어 내는 것` 에 그치면 안되고, `유지 보수가 쉬운 코드, 적게 짜서 해결할 수 있는 좋은 구조의 코드`를 생각해내야 한다.