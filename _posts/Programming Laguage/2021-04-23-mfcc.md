---
layout: posts
title: "[Python] Librosa MFCCë¥¼ í†µí•´ ìŒì„± ë°ì´í„°ì—ì„œ íŠ¹ì§• ì¶”ì¶œí•˜ê¸°"
categories:
  - Python
last_modified_at: 2021-02-03
author_profile: true
tags:
  - svm
  - librosa
toc: true
toc_sticky: true
sidebar:
  title: Posts
  nav: "sidebar-contents"
---

## Librosa ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŒì„± ë°ì´í„°ì—ì„œ MFCCë¥¼ ì¶”ì¶œí•´ë³´ìž.

MFCCëŠ” **ìŒì„± ë°ì´í„°ë¥¼ íŠ¹ì§•ë²¡í„°í™”**í•´ì£¼ëŠ” ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ, ì•„ë‚ ë¡œê·¸ ì‹ í˜¸ì¸ ìŒì„± ë°ì´í„°ë¥¼ **ë²¡í„°í™”**í•¨ìœ¼ë¡œì¨ ë¨¸ì‹ ëŸ¬ë‹ì—ì„œ í•™ìŠµ ë°ì´í„°ë¡œ ì‚¬ìš©í•  ìˆ˜ ìžˆê²Œ ëœë‹¤.

íŒŒì´ì¬ì˜ ```librosa```ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ ê°„ë‹¨í•˜ê²Œ MFCCë¥¼ ì¶”ì¶œí•  ìˆ˜ ìžˆë‹¤.

#### ðŸ“ ìŒì„± ë°ì´í„° load

-----

íŒŒì¼ ê²½ë¡œë¥¼ ì§€ì •í•´ì¤€ ë’¤ ```librosa.load```ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ë¡œë“œí•˜ìž.

```python
import librosa

filepath = '/content/drive/MyDrive/cut2/cuts10_anger_M_a17_1.wav'
signal, sr = librosa.load(filepath, sr=16000)
```


```sr(sampling rate)```ì€ ìŒì„± ë°ì´í„°ì˜ í˜•ì‹ì— ë”°ë¼ ë‹¤ë¥¸ë°, ```.wav```íŒŒì¼ì˜ ê²½ìš° 16000ì´ë‹¤.

#### ðŸ” MFCC ì¶”ì¶œ

-----

ë‹¤ìŒìœ¼ë¡œëŠ” ìŒì„± ë°ì´í„°ì—ì„œ íŠ¹ì§• ë²¡í„°ë¥¼ ì¶”ì¶œí•´ë³´ìž.

```python
import librosa

MFCCs = librosa.feature.mfcc(signal, sr)
```

ìœ„ì˜ ì½”ë“œë¥¼ ë³´ë©´ ì•Œ ìˆ˜ ìžˆë“¯ì´ mfccë¥¼ ì¶”ì¶œí•˜ëŠ” ê²ƒì€ ìƒë‹¹ížˆ ê°„ë‹¨í•˜ì§€ë§Œ, íŒŒë¼ë¯¸í„° ì„¤ì •ì— ë”°ë¼ í° ì°¨ì´ë¥¼ ë³´ì´ë¯€ë¡œ ë‹¤ë£¨ê³ ìž í•˜ëŠ” ìŒì„± ë°ì´í„°ì— ë§žê²Œ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°ì •í•´ì£¼ëŠ”ê²ƒì´ ì¢‹ë‹¤.

#### ðŸ§ª íŒŒë¼ë¯¸í„° ìµœì í™”

----

##### 1) sr(sampling rate)
default ê°’ì€ 22050Hzì´ë©° ì•žì„œ ë°ì´í„°ë¥¼ ë¡œë“œí•  ë•Œ 16000Hzë¡œ ë°›ì•˜ìœ¼ë¯€ë¡œ srê°’ì„ ë™ì¼í•˜ê²Œ ì„¤ì •í•´ ì¤€ë‹¤. 


##### 2) n_fft
ìŒì„±ì˜ ê¸¸ì´ë¥¼ ì–¼ë§Œí¼ìœ¼ë¡œ ìžë¥¼ì§€(frame lengthë¥¼ ê²°ì •)ì— ëŒ€í•œ íŒŒë¼ë¯¸í„°ë‹¤. ìžì—°ì–´ ì²˜ë¦¬ì—ì„œëŠ” frame lengthë¥¼ 25msë¥¼ ê¸°ë³¸ìœ¼ë¡œ í•œë‹¤. n_fftë¥¼ 400ìœ¼ë¡œ ì„¤ì •í•˜ê²Œ ë˜ë©´ frame lengthê°€ 0.025(n_fft/sr), ì¦‰ 25msê°€ ëœë‹¤.

##### 3) hop_length
hop_lengthëŠ” ê·¸ ê¸¸ì´ë§Œí¼ ë°ì´í„°ë¥¼ ì½ì–´ê°„ë‹¤. frame stride = 10msê°€ defaultì´ë¯€ë¡œ, ```sr * frame_stride = 160```ë¥¼ í†µí•´ hop_lengthë¥¼ 160ìœ¼ë¡œ ì„¤ì •í•´ì¤€ë‹¤.

##### 4) n_mfcc
íŠ¹ì§• ë²¡í„°ì˜ ê°œìˆ˜ë¥¼ ì •í•´ì£¼ëŠ” íŒŒë¼ë¯¸í„°ë¡œ defaultëŠ” 20ì´ë‹¤. ê°’ì´ ì»¤ì§ˆìˆ˜ë¡ ë” ë§Žì€ íŠ¹ì§•ë²¡í„°ë¥¼ ì¶”ì¶œí•˜ê²Œ ë˜ëŠ”ë°, ëŒ€ì‹ ì— ì‹œê°„ì´ ë§¤ìš° ì˜¤ëž˜ê±¸ë¦°ë‹¤.

10ë¶€í„° 100ê¹Œì§€ ë‹¤ì–‘í•œ ê°’ë“¤ì„ ë„£ì–´ í…ŒìŠ¤íŠ¸ í•œ ê²°ê³¼(ì‹¤ì œë¡œ svmì„ ëŒë ¤ì„œ ì •í™•ë„ë¥¼ ë¹„êµí•´ë´„), 36ê³¼ 50ì´ ë†’ê²Œ ë‚˜ì™”ìœ¼ë©° ë‘˜ì˜ ì°¨ì´ê°€ í¬ê²Œ ì—†ì–´ 36ìœ¼ë¡œ ê²°ì •í–ˆë‹¤. 

----

ìœ„ì˜ ë³€ê²½ì‚¬í•­ì„ ëª¨ë‘ í•©ì¹˜ê³ , cut2íŒŒì¼ì— ìžˆëŠ” ëª¨ë“  ìŒì„± íŒŒì¼ë“¤ì˜ MFCCë¥¼ ì¶”ì¶œí•˜ëŠ” ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```python
from imutils import paths
import os
import librosa


def getMFCC(filepath):
  signal, sr = librosa.load(filepath, sr=16000)

  # MFCCë¥¼ í†µí•œ íŠ¹ì§• ë²¡í„° ì¶”ì¶œ (n_mfcc=36)
  MFCCs = librosa.feature.mfcc(signal, sr, n_fft=400, hop_length=160, n_mfcc=36)
  return MFCCs

# íŒŒì¼ì„ ì½ì–´ì˜¬ í´ë” ê²½ë¡œ ì§€ì •
forder = '/content/drive/MyDrive/cut2'
files = paths.list_files(forder)

for i in files:
  mfcc=getMFCC(i)
```



*ì°¸ê³ í•œ ë¸”ë¡œê·¸
><a href="https://kaen2891.tistory.com/39">https://kaen2891.tistory.com/39</a>
><a href="https://youdaeng-com.tistory.com/5">https://youdaeng-com.tistory.com/5</a>